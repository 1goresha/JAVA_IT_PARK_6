# Структура проекта

* `*.idea*` - служебная папка IntelliJ IDEA
* `*src*` - папка с исходным кодом
	* `*main*` - главный исхоный код
		* `*java/ru.itpark*` - исходный код проекта на java
			* `*filters*` - классы, которые обрабатывают запрос до того, как он дойдет до сервлетов. 
			* `*forms*` - классы, объекты которых хранят данные, переданные с веб-страниц.
			* `*models*` - классы - модели предметной области.
			* `*repositories*` - классы, которые реализуют паттерн DAO (DataAccessObject), представлены интерфейсами для работы с моделями, и реализациями этих интерфейсов для работы с конкретной СУБД
			* `*services*` - классы, которые содержат основную логику приложения (бизнес-логика, описывает бизнес-процессы). Обращаются к репозиториям.
			* `*servlets*` - классы, которые работают в HTTP-протоколом, обращаются к сервисам.
		* `*resources*` - файлы ресурсов
			* `*ru.itpark.config/context.xml*` - файл конфигурации Spring, в нем объявляются бины - компоненты, которые будут использоваться в системе
		* `*webapp/WEB-INF*` - файлы для web-приложения
			* `*jsp*` - jsp-страницы
			* `*web.xml*` - дескриптор развертывания, нужен Tomcat, чтобы понять какие сервлеты и на какие урлы мы отображем. Даже если сервер помечен аннотацией @WebSerlvet, наличие web.xml обязательно
	* `*test*` - исходный код модульных тестов
* `*target*` - папка с скомпилированными файлами и собранными архивами (war/jar)
* `*ProjectName.iml*` - файл проекта IntelliJ IDEA
* `*pom.xml*` - файл Maven-проекта в котором указываются зависимости

## Замечания

* Аннотация @WebServlet - аннотация пакета javax.serlvet-api

* Вывод страниц происходит с помощью объекта PrintWriter объекта Reponse.

* Сервлет дергает контекст Spring в методе init


## JSP

* JavaServerPages - технология, позволяющая разделить логику работы страницы и логику отдачи страницы.

* JSP-страница компилируется в сервлет специальным компилятором Jasper. Данный сервлет выводит необходимую информацию через out.print.

* Таким образом, данный код:

```JAVA
req.getRequestDispatcher("WEB-INF/jsp/users.jsp").forward(req,resp);
```

передает запрос из UsersServlet сервлету users_jsp, который был скопилирован на основе user.jsp-страницы.

* Для того, чтобы избежать необходимости написания Java-кода внутри страницы, используют технологию JSTL. Данную технологию можно использовать, если подключить соответствующую библиотеку.

## Обеспечение безопасности

Цикл:

1. Пользователь сообщает серверу свой логин и пароль
2. Сервер генерирует определенную случайную текстовую строку и сохраняет в БД, которую кладет в куки и передает клиенту.
3. Клиент сохраняет эту строку у себя.
4. Клиент при обращении к какой либо странице сервера передает данную строку.
5. Сервер проверяет, есть ли такая строка в БД, если есть - то разрешает доступ, если нет - не разрешает.

* Когда сервер просит сохранить браузер куку, он отправляет в ответе заголовок

```
Set-Cookie: название=значение
```

## ServletFilter

* Встречает запрос, до того как он уйдет сервлетан.

* Чтобы запрос пошел дальше, необходимо вызвать filterChain.doFilter